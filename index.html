<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nesne EÅŸleme â€“ Pika & Berk</title>

<style>

/* GENEL RESET */
body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    background: #eef3ff;
    font-family: Arial, sans-serif;
    user-select: none;
}

/* ANA MENÃœ */
#menu {
    width: 100%;
    height: 100vh;
    background: linear-gradient(135deg, #89c4ff, #4a8bff);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

.menu-title {
    font-size: 32px;
    color: white;
    font-weight: bold;
    margin-bottom: 30px;
}

.menu-btn {
    width: 240px;
    padding: 14px;
    background: white;
    color: #333;
    border-radius: 14px;
    margin: 7px 0;
    text-align: center;
    font-size: 20px;
    font-weight: bold;
    cursor: pointer;
    transition: 0.2s;
}
.menu-btn:hover {
    background: #f1f1f1;
}

/* OYUN ALANI */
#gameArea {
    width: 100%;
    height: 100vh;
    display: none;
    position: relative;
}

/* SÃœRÃœKLÃœ Ã‡IKIÅž BAR */
#exitSliderContainer {
    width: 90%;
    height: 60px;
    background: #d7e2ff;
    border: 3px solid #8aa8ff;
    border-radius: 40px;
    position: absolute;
    top: 10px;
    left: 5%;
    display: flex;
    align-items: center;
    overflow: hidden;
}

#exitText {
    position: absolute;
    left: 20px;
    font-weight: bold;
    font-size: 18px;
    color: #2f3e72;
}

#exitHandle {
    width: 70px;
    height: 70px;
    background: #4a8bff;
    border-radius: 50%;
    position: absolute;
    left: 0;
    top: -5px;
    cursor: grab;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: bold;
    font-size: 22px;
}

/* ÃœST KARTLAR (SEÃ‡ENEKLER) */
.top-options {
    position: absolute;
    top: 100px;
    left: 50%;
    transform: translateX(-50%);
    width: 90%;
    display: flex;
    justify-content: center;
    gap: 22px;
}

/* TEK KART */
.card {
    width: 160px;
    height: 200px;
    background: white;
    border-radius: 14px;
    border: 4px solid #d0d0d0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: space-between;
    padding: 6px;
}

.card img {
    width: 85%;
    height: auto;
    margin: 4px 0;
}

/* SÃœRÃœKLENEN KART */
#dragCard {
    position: absolute;
    width: 180px;
    height: 230px;
    left: calc(50% - 90px);
    top: 420px;
    background: white;
    border-radius: 14px;
    border: 4px solid #5d7cff;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: space-between;
    padding: 6px;
}

/* YÃ–NERGE KUTUSU â€” SOL ALTA */
.instruction-box {
    position: absolute;
    bottom: 10px;
    left: 10px;
    width: 260px;
    height: 110px;
    background: white;
    border-radius: 14px;
    border: 3px solid #5a6cb8;
    padding: 10px;
    font-weight: bold;
}

/* SEMBOL BAR â€” ALTTA */
#symbolBar {
    position: absolute;
    bottom: 150px;
    left: 50%;
    transform: translateX(-50%);
    width: 420px;
    height: 60px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.symbol {
    width: 42px;
    height: 42px;
    font-size: 32px;
    text-align: center;
}

/* SEMBOL TAHTASI â€” SAÄž ALT */
#symbolBoard {
    position: absolute;
    right: 20px;
    bottom: 20px;
    width: 260px;
    height: 120px;
    background: #fff6db;
    border-radius: 18px;
    border: 3px solid #c9a85b;
    padding: 10px;
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 8px;
}

/* SES TUÅžU */
#soundBtn {
    position: absolute;
    top: 90px;
    right: 15px;
    padding: 10px 16px;
    border-radius: 14px;
    border: none;
    background: #ffdd66;
    font-weight: bold;
    cursor: pointer;
}

</style>
</head>
<body>


<!-- ===================== MENÃœ ===================== -->
<script>
function startGame(mode) {
    window.selectedMode = mode;

    // menÃ¼yÃ¼ kapat, oyunu aÃ§
    document.getElementById("menu").style.display = "none";
    document.getElementById("gameArea").style.display = "block";

    // sembolleri sÄ±fÄ±rla
    if (typeof resetSymbols === "function") resetSymbols();

    // yeni tur baÅŸlat
    if (typeof createNewRound === "function") createNewRound();
}
</script>
<div id="menu">
    <div class="menu-title">Nesne EÅŸleme</div>

    <div class="menu-btn" onclick="startGame(1)">1 SeÃ§enekli EÅŸleme</div>
    <div class="menu-btn" onclick="startGame(2)">2 SeÃ§enekli EÅŸleme</div>
    <div class="menu-btn" onclick="startGame(3)">3 SeÃ§enekli EÅŸleme</div>
    <div class="menu-btn" onclick="startGame(4)">4 SeÃ§enekli EÅŸleme</div>
    <div class="menu-btn" onclick="startGame(5)">5 SeÃ§enekli EÅŸleme</div>
    <div class="menu-btn" onclick="startGame(7)">7 SeÃ§enekli EÅŸleme</div>
</div>


<!-- ===================== OYUN ALANI ===================== -->

<div id="gameArea">

    <!-- Ã‡IKIÅž SÃœRGÃœSÃœ -->
    <div id="exitSliderContainer">
        <div id="exitText">MENÃœYE DÃ–NMEK Ä°Ã‡Ä°N SÃœRÃœKLE â†’</div>
        <div id="exitHandle">â—‰</div>
    </div>
    <!-- ÃœSTTEKÄ° EÅžLEME SEÃ‡ENEKLERÄ° -->
    <div id="optionsRow" class="top-options"></div>

    <!-- SÃœRÃœKLENEN KARTIMIZ -->
    <div id="dragCard" class="card">
        <div id="dragTR" style="margin-top:4px;"></div>
        <img id="dragIMG" src="">
        <div id="dragEN" style="margin-bottom:6px; font-style:italic;"></div>
    </div>

    <!-- YÃ–NERGE KUTUSU -->
    <div class="instruction-box">
        <div style="font-size:15px;">YÃ–NERGE :</div>
        <div style="font-size:14px;">EÅŸle</div>
        <div style="font-size:14px;">AynÄ± olanÄ± eÅŸle</div>
        <div id="instructionText" style="font-size:16px; margin-top:8px;"></div>
    </div>

    <!-- SEMBOL BAR (KARTIN ALTINDA) -->
    <div id="symbolBar"></div>

    <!-- SEMBOL TAHTASI (SAÄž ALT) -->
    <div id="symbolBoard"></div>

    <!-- SES AÃ‡ / KAPAT -->
    <button id="soundBtn" onclick="toggleSound()">ðŸ”Š Ses AÃ§Ä±k</button>

</div> <!-- gameArea kapanÄ±ÅŸÄ± -->


<!-- BURADAN SONRA PARÃ‡A 3 GELECEK -->
<script>
/* ============================================================
   PARÃ‡A 3 â€” OYUN MOTORU (SEÃ‡ENEK ÃœRETME + ROUND SÄ°STEMÄ°)
============================================================ */

let optionCount = 1;
let currentTarget = null;
let currentOptions = [];
let dragging = false;
let audioOn = true;
let symbolsCollected = 0;

/* ===================== NESNE LÄ°STESÄ° ===================== */

const items = [
    {tr:"Elma", en:"Apple", img:"assets/elma.png"},
    {tr:"Armut", en:"Pear", img:"assets/armut.png"},
    {tr:"Muz", en:"Banana", img:"assets/muz.png"},
    {tr:"Karpuz", en:"Watermelon", img:"assets/karpuz.png"},
    {tr:"Kavun", en:"Melon", img:"assets/kavun.png"},
    {tr:"Ã‡ilek", en:"Strawberry", img:"assets/cilek.png"},
    {tr:"Portakal", en:"Orange", img:"assets/portakal.png"},
    {tr:"Kivi", en:"Kiwi", img:"assets/kivi.png"},
    {tr:"ÃœzÃ¼m", en:"Grapes", img:"assets/uzum.png"},
    {tr:"Ananas", en:"Pineapple", img:"assets/ananas.png"},

    {tr:"Domates", en:"Tomato", img:"assets/domates.png"},
    {tr:"Biber", en:"Pepper", img:"assets/biber.png"},
    {tr:"SoÄŸan", en:"Onion", img:"assets/sogan.png"},
    {tr:"SarÄ±msak", en:"Garlic", img:"assets/sarimsak.png"},
    {tr:"Brokoli", en:"Broccoli", img:"assets/brokoli.png"},
    {tr:"HavuÃ§", en:"Carrot", img:"assets/havuc.png"},
    {tr:"Lahana", en:"Cabbage", img:"assets/lahana.png"},
    {tr:"MÄ±sÄ±r", en:"Corn", img:"assets/misir.png"},
    {tr:"PatlÄ±can", en:"Eggplant", img:"assets/patlican.png"},

    {tr:"KÃ¶pek", en:"Dog", img:"assets/kopek.png"},
    {tr:"Kedi", en:"Cat", img:"assets/kedi.png"},
    {tr:"Aslan", en:"Lion", img:"assets/aslan.png"},
    {tr:"AyÄ±", en:"Bear", img:"assets/ayi.png"},
    {tr:"At", en:"Horse", img:"assets/at.png"},
    {tr:"TavÅŸan", en:"Rabbit", img:"assets/tavsan.png"},
    {tr:"Tavuk", en:"Chicken", img:"assets/tavuk.png"},
    {tr:"Koyun", en:"Sheep", img:"assets/koyun.png"},
    {tr:"Ä°nek", en:"Cow", img:"assets/inek.png"},
    {tr:"Kaplan", en:"Tiger", img:"assets/kaplan.png"},

    {tr:"Araba", en:"Car", img:"assets/araba.png"},
    {tr:"Kamyon", en:"Truck", img:"assets/kamyon.png"},
    {tr:"OtobÃ¼s", en:"Bus", img:"assets/otobus.png"},
    {tr:"Gemi", en:"Ship", img:"assets/gemi.png"},
    {tr:"UÃ§ak", en:"Plane", img:"assets/ucak.png"},
    {tr:"Helikopter", en:"Helicopter", img:"assets/helikopter.png"},
    {tr:"Motosiklet", en:"Motorcycle", img:"assets/motosiklet.png"},
    {tr:"Bisiklet", en:"Bicycle", img:"assets/bisiklet.png"},
    {tr:"Tren", en:"Train", img:"assets/tren.png"},
    {tr:"Ä°tfaiye", en:"Firetruck", img:"assets/itfaiye.png"}
];

/* ========= MENÃœ â†’ OYUN GEÃ‡Ä°ÅžÄ° ========= */
function startGame(n){
    optionCount = n;

    document.getElementById("menu").style.display = "none";
    document.getElementById("gameArea").style.display = "block";

    resetSymbols();
    createNewRound();
}

/* ========= KARIÅžTIR ========= */
function shuffle(arr){
    for (let i = arr.length - 1; i > 0; i--){
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
    }
}

/* ========= YENÄ° ROUND ========= */
function createNewRound(){

    /* SeÃ§enekleri belirle */
    currentOptions = [...items];
    shuffle(currentOptions);
    currentOptions = currentOptions.slice(0, optionCount);

    /* Hedefi seÃ§ */
    currentTarget = currentOptions[Math.floor(Math.random() * currentOptions.length)];

    /* YÃ¶nerge yazÄ±sÄ± */
    document.getElementById("instructionText").innerText =
        `${currentTarget.tr.toUpperCase()}YI EÅžLE`;

    /* SÃ¼rÃ¼klenen kart */
    document.getElementById("dragTR").innerText = currentTarget.tr.toUpperCase();
    document.getElementById("dragIMG").src = currentTarget.img;
    document.getElementById("dragEN").innerText = currentTarget.en;

    /* Ãœst seÃ§enek kartlarÄ±nÄ± oluÅŸtur */
    fillOptions();
}

/* ========= Ãœst KartlarÄ± YerleÅŸtir ========= */
function fillOptions(){
    const row = document.getElementById("optionsRow");
    row.innerHTML = "";

    let temp = [...currentOptions];
    shuffle(temp);

    temp.forEach(item => {

        let c = document.createElement("div");
        c.className = "card";
        c.dataset.name = item.tr;

        c.innerHTML = `
            <div style="margin-top:4px; font-weight:800;">${item.tr.toUpperCase()}</div>
            <img src="${item.img}">
            <div style="font-size:14px; font-style:italic;">${item.en}</div>
        `;

        c.onclick = () => checkMatch(item, c);

        row.appendChild(c);
    });
}

/* ========= TIKLAMALI EÅžLEME ========= */
function checkMatch(selected, cardElement){
    if(selected.tr === currentTarget.tr){
        cardElement.style.borderColor = "#27ae60";

        giveSymbol();

        setTimeout(()=>{
            createNewRound();
        }, 600);

    } else {
        cardElement.style.borderColor = "#e74c3c";
        setTimeout(()=>{
            cardElement.style.borderColor = "#d0d0d0";
        }, 400);
    }
}
/* ============================================================
   PARÃ‡A 4 â€” DRAG & DROP + SESLER + SEMBOL SÄ°STEMÄ° + EXIT SLIDER
============================================================ */

/* ===================== DRAG & DROP ===================== */

const dragCard = document.getElementById("dragCard");

let offsetX = 0;
let offsetY = 0;

dragCard.addEventListener("mousedown", startDrag);
document.addEventListener("mouseup", stopDrag);
document.addEventListener("mousemove", dragMove);

function startDrag(e){
    dragging = true;
    dragCard.style.transition = "0s";
    offsetX = e.clientX - dragCard.offsetLeft;
    offsetY = e.clientY - dragCard.offsetTop;
}

function dragMove(e){
    if (!dragging) return;

    dragCard.style.left = (e.clientX - offsetX) + "px";
    dragCard.style.top  = (e.clientY - offsetY) + "px";
}

function stopDrag(){
    if(!dragging) return;
    dragging = false;

    checkDrop();
}

function resetDrag(){
    dragCard.style.transition = "0.4s";
    dragCard.style.left = "calc(50% - 90px)";
    dragCard.style.top  = "420px";
}

/* ========= KART TEMAS KONTROLÃœ ========= */
function checkDrop(){
    const options = [...document.querySelectorAll(".card")].filter(c => c !== dragCard);

    const dragRect = dragCard.getBoundingClientRect();

    for (let opt of options){
        const rect = opt.getBoundingClientRect();

        const intersects =
            !(dragRect.right < rect.left ||
              dragRect.left > rect.right ||
              dragRect.bottom < rect.top ||
              dragRect.top > rect.bottom);

        if(intersects){
            if(opt.dataset.name === currentTarget.tr){
                opt.style.borderColor = "#2ecc71";
                giveSymbol();
                setTimeout(()=>{
                    resetDrag();
                    createNewRound();
                },600);
            } else {
                opt.style.borderColor = "#e74c3c";
                setTimeout(()=> opt.style.borderColor="#d0d0d0", 400);
                resetDrag();
            }
            return;
        }
    }

    resetDrag();
}


/* ===================== SES SÄ°STEMÄ° ===================== */

let praiseSounds = [
    new Audio("ses/aferin.mp3"),
    new Audio("ses/bravo.mp3"),
    new Audio("ses/supersin.mp3"),
    new Audio("ses/harika.mp3")
];

let countSounds = [
    new Audio("ses/1.mp3"),
    new Audio("ses/2.mp3"),
    new Audio("ses/3.mp3"),
    new Audio("ses/4.mp3"),
    new Audio("ses/5.mp3"),
    new Audio("ses/6.mp3"),
    new Audio("ses/7.mp3"),
    new Audio("ses/8.mp3")
];

let finishSound = new Audio("ses/finish.mp3");

function toggleSound(){
    audioOn = !audioOn;
    document.getElementById("soundBtn").innerText =
        audioOn ? "ðŸ”Š Ses AÃ§Ä±k" : "ðŸ”‡ Ses KapalÄ±";
}

function playPraise(){
    if(!audioOn) return;
    let sound = praiseSounds[Math.floor(Math.random()*praiseSounds.length)];
    sound.play();
}


/* ===================== SEMBOL SÄ°STEMÄ° ===================== */

function resetSymbols(){
    symbolsCollected = 0;

    const bar = document.getElementById("symbolBar");
    bar.innerHTML = "";
    for (let i=0; i<8; i++){
        let d = document.createElement("div");
        d.className = "symbol";
        d.dataset.index = i;
        d.textContent = "â­";
        d.style.opacity = "0.25";
        bar.appendChild(d);
    }

    const board = document.getElementById("symbolBoard");
    board.innerHTML = "";
    for (let i=0; i<8; i++){
        let d = document.createElement("div");
        d.className = "symbol";
        d.dataset.slot = i;
        d.textContent = "â­";
        d.style.opacity = "0.15";
        board.appendChild(d);
    }
}

function animateStar(targetIndex){
    const fly = document.createElement("div");
    fly.textContent = "â­";
    fly.style.position = "absolute";
    fly.style.left = "50%";
    fly.style.top = "50%";
    fly.style.fontSize = "40px";
    fly.style.transform = "translate(-50%, -50%) scale(0.1)";
    fly.style.transition = "0.6s";
    fly.style.zIndex = "999";
    document.body.appendChild(fly);

    setTimeout(()=>{
        const slot = document.querySelector(`[data-slot='${targetIndex}']`);
        const rect = slot.getBoundingClientRect();
        fly.style.left = rect.left + "px";
        fly.style.top  = rect.top + "px";
        fly.style.transform = "scale(1)";
        fly.style.opacity = "0.1";
    },50);

    setTimeout(()=> fly.remove(),650);
}

function giveSymbol(){
    playPraise();
    animateStar(symbolsCollected);

    const barSlot = document.querySelector(`[data-index='${symbolsCollected}']`);
    barSlot.style.opacity = "1";

    const boardSlot = document.querySelector(`[data-slot='${symbolsCollected}']`);
    boardSlot.style.opacity = "1";

    symbolsCollected++;

    if(symbolsCollected >= 8){
        setTimeout(()=> countSymbols(), 700);
    }
}

function countSymbols(){
    if(!audioOn){
        resetSymbols();
        createNewRound();
        return;
    }

    let i = 0;

    function next(){
        if(i < 8){
            countSounds[i].play();
            i++;
            setTimeout(next,900);
        } else {
            finishSound.play();
            setTimeout(()=>{
                resetSymbols();
                createNewRound();
            },1500);
        }
    }

    next();
}


/* ===================== Ã‡IKIÅž SÃœRGÃœSÃœ ===================== */

const exitHandle = document.getElementById("exitHandle");
const exitContainer = document.getElementById("exitSliderContainer");

let exitDragging = false;
let exitStartX = 0;

exitHandle.addEventListener("mousedown", e=>{
    exitDragging = true;
    exitStartX = e.clientX - exitHandle.offsetLeft;
    exitHandle.style.transition = "0s";
});

document.addEventListener("mouseup", ()=>{
    if(exitDragging){
        exitDragging = false;
        let maxX = exitContainer.clientWidth - exitHandle.clientWidth - 5;

        if(exitHandle.offsetLeft >= maxX - 10){
            // MenÃ¼yÃ¼ aÃ§
            document.getElementById("gameArea").style.display = "none";
            document.getElementById("menu").style.display = "flex";
        } else {
            // BaÅŸlangÄ±Ã§ noktasÄ±na geri dÃ¶n
            exitHandle.style.transition = "0.5s";
            exitHandle.style.left = "0px";
        }
    }
});

document.addEventListener("mousemove", e=>{
    if(!exitDragging) return;

    let newX = e.clientX - exitStartX;
    let maxX = exitContainer.clientWidth - exitHandle.clientWidth - 5;

    if(newX < 0) newX = 0;
    if(newX > maxX) newX = maxX;

    exitHandle.style.left = newX + "px";
});
